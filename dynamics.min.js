var canvas=document.createElement("canvas");canvas.id="my-canvas",c=canvas.getContext("2d"),c.fillStyle="black",ballX=100,radius=20,canvas.width=document.body.clientWidth,canvas.height=document.body.clientHeight;var offSet=.15*canvas.height,groundLevel=canvas.height-offSet,ceiling=offSet,ballY=groundLevel-radius,togglespeed=10,toggle=!1,obstacleHeight=20,generateflag=!1,ugenerateflag=!1,spacestate=3,length=6,obst=[],uobst=[],ballReached=!1,thorn=new Image,fireball1=new Image,fireball4=new Image,sleft=new Image,sup=new Image,sdown=new Image,owidth=50,oheight=50,uobstspeed=5,obstspeed=6,fireballspeed=10,fwidth=100,fheight=50,fX=-3*fwidth,fY=250,state=0,score=0,spaceX=100,spacewidth=50,spaceheight=50,spaceY=groundLevel-spacewidth,body=document.getElementById("main"),firsthalf=c.createLinearGradient(0,ceiling,0,(ceiling+groundLevel)/2);firsthalf.addColorStop(0,"#696969"),firsthalf.addColorStop(1,"#A9A9A9");var secondhalf=c.createLinearGradient(0,groundLevel,0,(ceiling+groundLevel)/2);function drawBack(){c.fillStyle="black",c.fillRect(0,0,canvas.width,ceiling),c.fillRect(0,groundLevel,canvas.width,offSet),c.fillStyle=firsthalf,c.fillRect(0,ceiling,canvas.width,(ceiling+groundLevel)/2),c.fillStyle=secondhalf,c.fillRect(0,(groundLevel+ceiling)/2,canvas.width,(groundLevel+ceiling)/2-ceiling)}function gameOver(){for(;body.firstChild;)body.removeChild(body.firstChild);var e=document.createElement("h4");e.id="over",e.innerHTML="GAME OVER",e.style.color="white",body.appendChild(e);var t=document.createElement("button");t.id="restart",t.innerHTML="Restart",t.addEventListener("click",function(){window.location.reload(!0)}),localStorage.setItem("best",score),body.appendChild(t)}function drawSpaceship(){checkToggle(),determineState(),1==spacestate?c.drawImage(sup,spaceX,spaceY,spacewidth,spaceheight):2==spacestate?c.drawImage(sdown,spaceX,spaceY,spacewidth,spaceheight):3==spacestate&&c.drawImage(sleft,spaceX,spaceY,spacewidth,spaceheight)}function checkObstCoords(e){for(j=0;j<length;j++)e!=j&&(obst[e]<obst[j]<obst[e]+owidth?obst[e]-=owidth:obst[j]<obst[e]<obst[j]+owidth&&(obst[e]+=owidth),uobst[e]<uobst[j]<uobst[e]+owidth?uobst[e]-=owidth:uobst[j]<uobst[e]<uobst[j]+owidth&&(uobst[e]+=owidth))}function drawScore(){localStorage.getItem("score")}function generateObst(){for(obst[0]=canvas.width+10*Math.random(),i=1;i<length;i++)obst[i]=obst[i-1]+100+(2*canvas.width-obst[i-1]-100)*Math.random();for(generateflag=!0,uobst[0]=canvas.width+25*Math.random(),i=1;i<length;i++)uobst[i]=uobst[i-1]+100+(2*canvas.width-uobst[i-1]-30)*Math.random();for(ugenerateflag=!0,i=0;i<length;i++)for(;checkCoordslower(i);)obst[i]+=owidth;for(i=0;i<length;i++)for(;checkCoordsupper(i);)uobst[i]+=owidth}function checkObst(){for(i=0;i<length;i++){if(obst[i]>-owidth-10&&(obst[i]-=obstspeed),uobst[i]>-owidth-10&&(uobst[i]-=uobstspeed),obst[i]<=-owidth-10)for(score++,0==i?obst[i]=canvas.width+10*Math.random()+owidth:0!=i&&(obst[i]=canvas.width+1.5*Math.random()*canvas.width);checkCoordslower(i);)obst[i]+=owidth;if(uobst[i]<=-owidth-10)for(score++,0==i?uobst[i]=canvas.width+10*Math.random()+owidth:0!=i&&(uobst[i]=canvas.width+1.5*Math.random()*canvas.width);checkCoordsupper(i);)uobst[i]+=owidth}}function checkCoordslower(e){for(j=0;j<length;j++)if(e!=j&&(obst[e]<obst[j]&&obst[j]<obst[e]+owidth||obst[j]<obst[e]&&obst[e]<obst[j]+owidth))return!0;return!1}function checkCoordsupper(e){for(j=0;j<length;j++)if(e!=j&&(uobst[e]<uobst[j]&&uobst[j]<uobst[e]+owidth||uobst[j]<uobst[e]&&uobst[e]<uobst[j]+owidth))return!0;return!1}function drawObst(){if(generateflag)for(checkObst(),i=0;i<length;i++)c.save(),c.beginPath(),c.drawImage(thorn,obst[i],groundLevel-oheight,owidth,oheight),c.fill(),c.closePath(),c.beginPath(),c.drawImage(thorn,uobst[i],ceiling,owidth,oheight),c.closePath(),c.restore()}function collisionDetection(){var e=new Path2D,t=new Path2D,o=new Path2D;for(c.beginPath(o),o.moveTo(fX,fY),o.lineTo(fX+fwidth,fY),o.lineTo(fX+fwidth,fY+fheight),o.lineTo(fX,fY+fheight),o.lineTo(fX,fY),c.closePath(o),i=0;i<length;i++)c.beginPath(e),e.moveTo(obst[i],groundLevel),e.lineTo(obst[i],groundLevel-oheight),e.lineTo(obst[i]+owidth,groundLevel-oheight),e.lineTo(obst[i]+owidth,groundLevel-oheight),e.lineTo(obst[i]+owidth,groundLevel-oheight),c.closePath(e),c.beginPath(t),t.moveTo(uobst[i],ceiling),t.lineTo(uobst[i],ceiling+oheight),t.lineTo(uobst[i]+owidth,ceiling+oheight),t.lineTo(uobst[i]+owidth,ceiling),t.lineTo(uobst[i],ceiling),c.closePath(t);c.isPointInPath(e,spaceX,spaceY)&&gameOver(),c.isPointInPath(e,spaceX+spacewidth,spaceY)&&gameOver(),c.isPointInPath(e,spaceX+spacewidth,spaceY+spaceheight)&&gameOver(),c.isPointInPath(e,spaceX,spaceY+spaceheight)&&gameOver(),c.isPointInPath(t,spaceX,spaceY)&&gameOver(),c.isPointInPath(t,spaceX+spacewidth,spaceY)&&gameOver(),c.isPointInPath(t,spaceX+spacewidth,spaceY+spaceheight)&&gameOver(),c.isPointInPath(t,spaceX,spaceY+spaceheight)&&gameOver(),c.isPointInPath(o,spaceX+spacewidth,spaceY)&&gameOver(),c.isPointInPath(o,spaceX+spacewidth,spaceY+spaceheight)&&gameOver(),c.isPointInPath(o,spaceX,spaceY+spaceheight)&&gameOver(),c.isPointInPath(o,spaceX,spaceY)&&gameOver(),delete e,delete t,delete o}function onClick(e){0==e.button&&(toggle=!toggle)}function checkToggle(){toggle?spaceY>ceiling&&(spaceY-=togglespeed):toggle||spaceY<groundLevel-spacewidth&&(spaceY+=togglespeed)}function generateFireball(){fX=canvas.width+fwidth,fY=ceiling+oheight+30+Math.random()*(groundLevel-fheight-oheight-ceiling-oheight-60)}function drawFireball(){fX-=fireballspeed,1==state?c.drawImage(fireball1,fX,fY,fwidth,fheight):2==state&&c.drawImage(fireball4,fX,fY,fwidth,fheight)}function load(){thorn.src="thornguy.png",fireball1.src="fireball1.png",fireball4.src="fireball4.png",sup.src="spaceship-tilt-up.png",sdown.src="spaceship-tilt-down.png",sleft.src="spaceship-left.png",thorn.onload=function(){console.log("hello"),fireball1.onload=function(){sup.onload=function(){console.log("hihihi"),sdown.onload=function(){sleft.onload=function(){fireball4.onload=function(){console.log("hi"),draw()}}}}}},draw()}function stateincre(){3==++state&&(state=1)}function determineState(){spacestate=toggle&&spaceY>ceiling?1:!toggle&&spaceY<groundLevel-spacewidth?2:3}function drawScore(){c.font="2.5vw Arial",c.fillStyle="white",c.fillText("Score "+score,.05*canvas.width,.1*canvas.height),c.font="2.5vw Arial",c.fillStyle="white",best=localStorage.getItem("best"),c.fillText("Personal best: "+best,.75*canvas.width,.1*canvas.height)}function draw(){c.clearRect(0,0,canvas.width,canvas.height),collisionDetection(),drawBack(),drawObst(),drawFireball(),console.log(spaceY),drawSpaceship(),drawScore(),window.requestAnimationFrame(draw)}secondhalf.addColorStop(0,"#696969"),secondhalf.addColorStop(1,"#A9A9A9"),window.addEventListener("click",onClick),window.setInterval(generateFireball,5e3),window.setInterval(stateincre,250),button=document.getElementById("start"),button.addEventListener("click",function(){for(generateObst();body.firstChild;)body.removeChild(body.firstChild);body.appendChild(canvas),load()});